{"version":3,"file":"media.js","names":[],"sources":["../../src/@types/media.ts"],"sourcesContent":["/*\nCopyright 2024 The Matrix.org Foundation C.I.C.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\n\nimport { type MsgType } from \"../@types/event.ts\";\n\n/**\n * Information on encrypted media attachments.\n *\n * Used within `m.room.message` events that reference files, such as `m.file` and `m.image`.\n *\n * @see https://spec.matrix.org/v1.11/client-server-api/#extensions-to-mroommessage-msgtypes\n */\nexport interface EncryptedFile {\n    /**\n     * The URL to the file.\n     */\n    url: string;\n    /**\n     * A JSON Web Key object.\n     */\n    key: {\n        alg: string;\n        key_ops: string[]; // eslint-disable-line camelcase\n        kty: string;\n        k: string;\n        ext: boolean;\n    };\n    /**\n     * The 128-bit unique counter block used by AES-CTR, encoded as unpadded base64.\n     */\n    iv: string;\n    /**\n     * A map from an algorithm name to a hash of the ciphertext, encoded as unpadded base64.\n     * Clients should support the SHA-256 hash, which uses the key `sha256`.\n     */\n    hashes: { [alg: string]: string };\n    /**\n     * Version of the encrypted attachment's protocol. Must be `v2`.\n     */\n    v: string;\n}\n\ninterface ThumbnailInfo {\n    /**\n     * The mimetype of the image, e.g. image/jpeg.\n     */\n    mimetype?: string;\n    /**\n     * The intended display width of the image in pixels.\n     * This may differ from the intrinsic dimensions of the image file.\n     */\n    w?: number;\n    /**\n     * The intended display height of the image in pixels.\n     * This may differ from the intrinsic dimensions of the image file.\n     */\n    h?: number;\n    /**\n     * Size of the image in bytes.\n     */\n    size?: number;\n}\n\ninterface BaseInfo {\n    mimetype?: string;\n    size?: number;\n}\n\n/**\n * Information on media attachments of msgtype `m.file`\n *\n * Used within `m.room.message` events that reference files.\n *\n * @see https://spec.matrix.org/v1.11/client-server-api/#mfile\n */\nexport interface FileInfo extends BaseInfo {\n    /**\n     * Information on the encrypted thumbnail file, as specified in End-to-end encryption.\n     * Only present if the thumbnail is encrypted.\n     * @see https://spec.matrix.org/v1.11/client-server-api/#sending-encrypted-attachments\n     */\n    thumbnail_file?: EncryptedFile;\n    /**\n     * Metadata about the image referred to in thumbnail_url.\n     */\n    thumbnail_info?: ThumbnailInfo;\n    /**\n     * The URL to the thumbnail of the file. Only present if the thumbnail is unencrypted.\n     */\n    thumbnail_url?: string;\n}\n\n/**\n * Information on media attachments of msgtype `m.image`\n *\n * Used within `m.room.message` events that reference images.\n *\n * @see https://spec.matrix.org/v1.11/client-server-api/#mimage\n */\nexport interface ImageInfo extends FileInfo, ThumbnailInfo {}\n\n/**\n * Information on media attachments of msgtype `m.audio`\n *\n * Used within `m.room.message` events that reference audio files.\n *\n * @see https://spec.matrix.org/v1.11/client-server-api/#maudio\n */\nexport interface AudioInfo extends BaseInfo {\n    /**\n     * The duration of the audio in milliseconds.\n     */\n    duration?: number;\n}\n\n/**\n * Information on media attachments of msgtype `m.video`\n *\n * Used within `m.room.message` events that reference video files.\n *\n * @see https://spec.matrix.org/v1.11/client-server-api/#mvideo\n */\nexport interface VideoInfo extends AudioInfo, ImageInfo {\n    /**\n     * The duration of the video in milliseconds.\n     */\n    duration?: number;\n}\n\n/**\n * Union type representing the `content.info` field of all specified media events.\n */\nexport type MediaEventInfo = FileInfo | ImageInfo | AudioInfo | VideoInfo;\n\ninterface BaseContent {\n    /**\n     * Required if the file is encrypted. Information on the encrypted file, as specified in End-to-end encryption.\n     * @see https://spec.matrix.org/v1.11/client-server-api/#sending-encrypted-attachments\n     */\n    file?: EncryptedFile;\n    /**\n     * Required if the file is unencrypted. The URL (typically mxc:// URI) to the file.\n     */\n    url?: string;\n    /**\n     * If filename is not set or the value of both properties are identical,\n     * this is the filename of the original upload. Otherwise, this is a\n     * caption for the file.\n     */\n    body: string;\n    /**\n     * The original filename of the uploaded file.\n     */\n    filename?: string;\n    /**\n     * The format used in the `formatted_body`.\n     */\n    format?: \"org.matrix.custom.html\";\n    /**\n     * The formatted version of the `body`, when it acts as a caption. This is required if `format` is specified.\n     */\n    formatted_body?: string;\n}\n\n/**\n * Content format of media events with msgtype `m.file`\n *\n * @see https://spec.matrix.org/v1.11/client-server-api/#mfile\n */\nexport interface FileContent extends BaseContent {\n    /**\n     * Information about the file referred to in url.\n     */\n    info?: FileInfo;\n    /**\n     * One of: [m.file].\n     */\n    msgtype: MsgType.File;\n}\n\n/**\n * Content format of media events with msgtype `m.image`\n *\n * @see https://spec.matrix.org/v1.11/client-server-api/#mimage\n */\nexport interface ImageContent extends BaseContent {\n    /**\n     * Metadata about the image referred to in url.\n     */\n    info?: ImageInfo;\n    /**\n     * One of: [m.image].\n     */\n    msgtype: MsgType.Image;\n}\n\n/**\n * Content format of media events with msgtype `m.audio`\n *\n * @see https://spec.matrix.org/v1.11/client-server-api/#maudio\n */\nexport interface AudioContent extends BaseContent {\n    /**\n     * Metadata for the audio clip referred to in url.\n     */\n    info?: AudioInfo;\n    /**\n     * One of: [m.audio].\n     */\n    msgtype: MsgType.Audio;\n}\n\n/**\n * Content format of media events with msgtype `m.video`\n *\n * @see https://spec.matrix.org/v1.11/client-server-api/#mvideo\n */\nexport interface VideoContent extends BaseContent {\n    /**\n     * Metadata about the video clip referred to in url.\n     */\n    info?: VideoInfo;\n    /**\n     * One of: [m.video].\n     */\n    msgtype: MsgType.Video;\n}\n\n/**\n * Type representing media event contents for `m.room.message` events listed in the Matrix specification\n */\nexport type MediaEventContent = FileContent | ImageContent | AudioContent | VideoContent;\n"],"mappings":"","ignoreList":[]}